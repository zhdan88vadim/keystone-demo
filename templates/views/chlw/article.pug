extends layout.pug

block content
    -- console.log(viewModel.post)
    .article
        h1.under-line= viewModel.post.name
        div.article-body
            if (viewModel.post.image.filename && '/uploads/posts/img/' + viewModel.post.image.filename.exists)
                img(src='/uploads/posts/img/' + viewModel.post.image.filename).main-img
            div.content
                | !{viewModel.post.content.full}


        .files-audio
            if (viewModel.post.file0.filename)
                audio(controls  preload="none")
                    source(src='/uploads/posts/files/' + viewModel.post.file0.filename, type=viewModel.post.file0.mimetype)
                    | Тег audio не поддерживается вашим браузером.
                    <a href=#{'/public/uploads/posts/files/' + viewModel.post.file0.filename}>Скачайте музыку</a>.

            if (viewModel.post.file1.filename)
                audio(controls  preload="none")
                    source(src='/uploads/posts/files/' + viewModel.post.file1.filename, type=viewModel.post.file1.mimetype)
                    | Тег audio не поддерживается вашим браузером.
                    <a href=#{'/public/uploads/posts/files/' + viewModel.post.file1.filename}>Скачайте музыку</a>.

            if (viewModel.post.file2.filename)
                audio(controls  preload="none")
                    source(src='/uploads/posts/files/' + viewModel.post.file2.filename, type=viewModel.post.file2.mimetype)
                    | Тег audio не поддерживается вашим браузером.
                    <a href=#{'/public/uploads/posts/files/' + viewModel.post.file2.filename}>Скачайте музыку</a>.

            if (viewModel.post.file3.filename)
                audio(controls  preload="none")
                    source(src='/uploads/posts/files/' + viewModel.post.file3.filename, type=viewModel.post.file3.mimetype)
                    | Тег audio не поддерживается вашим браузером.
                    <a href=#{'/public/uploads/posts/files/' + viewModel.post.file3.filename}>Скачайте музыку</a>.



        if (viewModel.post.urls.length)
            .files-audio
                each url, i in viewModel.post.urls
                    audio(controls  preload="none")
                        source(src=url, type="audio/mpeg")
                        | Тег audio не поддерживается вашим браузером. 
                        <a href="audio/music.mp3">Скачайте музыку</a>.

            .files-download
                | Файлы для скачивания:

                each url, i in viewModel.post.urls
                    a(href=url) !{ siteUtils.getUrlTitle(url, 'Скачать файл') }

    .article-footer
        h3.relatedpost Похожие статьи
        .related-content
            each relatedPost, i in viewModel.relatedPosts
                a(href=relatedPost.key)
                    if relatedPost.image && relatedPost.image.filename
                        img(src=siteConst.path.image_posts + relatedPost.image.filename)
                    else
                        if relatedPost.author && relatedPost.author.photo && relatedPost.author.photo.filename
                                img(src=siteConst.path.image_users + relatedPost.author.photo.filename, alt=relatedPost.author.name.full)                    

                    div.relatedtitle= relatedPost.name
            .clear

    include partial/blog-comments.pug



